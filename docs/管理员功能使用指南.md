# ä½“è‚²çŸ¥è¯†æ™ºèƒ½é¢˜åº“å¹³å° - ç®¡ç†å‘˜åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç®¡ç†å‘˜åŠŸèƒ½æ¦‚è§ˆ

ç³»ç»Ÿå·²å®Œæ•´å®ç°ç®¡ç†å‘˜åŠŸèƒ½ï¼Œæ”¯æŒ**å¤šå±‚çº§æƒé™ç®¡ç†**ï¼š

### ğŸ”‘ è§’è‰²ä½“ç³»

| è§’è‰² | æƒé™èŒƒå›´ | ä¸»è¦åŠŸèƒ½ |
|------|---------|----------|
| **super_admin** | å…¨å¹³å° | ç³»ç»Ÿå…¨å±€ç®¡ç†ã€æœºæ„ç®¡ç†ã€ç”¨æˆ·ç®¡ç† |
| **admin** | æœºæ„çº§åˆ« | æœºæ„å†…ç”¨æˆ·ç®¡ç†ã€æ•°æ®ç»Ÿè®¡ã€å†…å®¹å®¡æ ¸ |
| **institution_admin** | æœºæ„ç®¡ç† | æœºæ„è®¾ç½®ã€ç”¨æˆ·ç®¡ç† |
| **teacher** | ç­çº§çº§åˆ« | ç­çº§ç®¡ç†ã€å­¦ç”Ÿè¿›åº¦ã€é¢˜ç›®ç®¡ç† |
| **content_manager** | å†…å®¹ç®¡ç† | é¢˜åº“ç®¡ç†ã€èµ„æºå®¡æ ¸ |

## ğŸš€ é¦–æ¬¡ä½¿ç”¨ - åˆ›å»ºè¶…çº§ç®¡ç†å‘˜

### 1. åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜
npm run create-admin

# æˆ–è€…åœ¨å¼€å‘ç¯å¢ƒä¸­
npm run create-admin:dev
```

**é»˜è®¤è¶…çº§ç®¡ç†å‘˜ä¿¡æ¯ï¼š**
- **ç”¨æˆ·å**: `superadmin`
- **é‚®ç®±**: `admin@sportsplatform.com`
- **å¯†ç **: `Admin123456`
- **è§’è‰²**: `super_admin`

### 2. ç™»å½•ç®¡ç†åå°

ä½¿ç”¨ä»¥ä¸‹ä»»ä¸€æ–¹å¼ç™»å½•ï¼š

**POST** `/api/auth/login`
```json
{
  "username": "superadmin",     // æˆ–ä½¿ç”¨é‚®ç®±: "admin@sportsplatform.com"
  "password": "Admin123456"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "user": {
      "id": "...",
      "username": "superadmin",
      "email": "admin@sportsplatform.com",
      "role": "super_admin",
      "institution": {...}
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

## ğŸ”§ ç®¡ç†å‘˜æ ¸å¿ƒåŠŸèƒ½

### 1. æœºæ„ç®¡ç† (Super Admin)

#### åˆ›å»ºæœºæ„
**POST** `/api/institutions`
```json
{
  "name": "ç¤ºä¾‹å­¦æ ¡",
  "type": "high_school",
  "description": "ç¤ºä¾‹é«˜ä¸­",
  "contact": {
    "email": "contact@example.edu.cn",
    "phone": "021-12345678"
  },
  "settings": {
    "maxUsers": 2000,
    "enabledFeatures": ["basic", "analytics", "ai_features"]
  }
}
```

#### æœºæ„ç®¡ç†åŠŸèƒ½
- âœ… è·å–æœºæ„åˆ—è¡¨: `GET /api/institutions`
- âœ… æœºæ„è¯¦æƒ…æŸ¥çœ‹: `GET /api/institutions/:id`
- âœ… æ›´æ–°æœºæ„ä¿¡æ¯: `PUT /api/institutions/:id`
- âœ… åˆ é™¤æœºæ„: `DELETE /api/institutions/:id`
- âœ… æœºæ„ç”¨æˆ·ç®¡ç†: `GET/POST /api/institutions/:id/users`
- âœ… æœºæ„ç»Ÿè®¡æ•°æ®: `GET /api/institutions/:id/stats`
- âœ… æ‰¹é‡æ“ä½œ: `POST /api/institutions/batch`

### 2. ç”¨æˆ·ç®¡ç†

#### è·å–ç”¨æˆ·åˆ—è¡¨
**GET** `/api/users` (éœ€è¦ admin/super_admin æƒé™)

#### åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
```bash
# åˆ›å»ºæ™®é€šç®¡ç†å‘˜
npm run create-admin adminuser admin@school.com Password123 "å­¦æ ¡åç§°"
```

#### ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- âœ… ç”¨æˆ·åˆ—è¡¨æŸ¥çœ‹: `GET /api/users`
- âœ… ç”¨æˆ·è¯¦æƒ…: `GET /api/users/:id`
- âœ… æ›´æ–°ç”¨æˆ·: `PUT /api/users/:id`
- âœ… åˆ é™¤ç”¨æˆ·: `DELETE /api/users/:id`
- âœ… é‡ç½®å¯†ç : `POST /api/users/:id/reset-password`
- âœ… æ‰¹é‡æ“ä½œ: `POST /api/users/batch`

### 3. ç­çº§ç®¡ç†

#### ç­çº§ç®¡ç†åŠŸèƒ½
- âœ… ç­çº§åˆ—è¡¨: `GET /api/classes`
- âœ… åˆ›å»ºç­çº§: `POST /api/classes`
- âœ… ç­çº§è¯¦æƒ…: `GET /api/classes/:id`
- âœ… å­¦ç”Ÿç®¡ç†: `GET/POST /api/classes/:id/students`
- âœ… ç­çº§ç»Ÿè®¡: `GET /api/classes/:id/stats`
- âœ… å­¦ä¹ è¿›åº¦: `GET /api/classes/:id/progress`

### 4. å­¦ç”Ÿè¿›åº¦ç®¡ç†

#### è¿›åº¦ç›‘æ§åŠŸèƒ½
- âœ… å­¦ç”Ÿè¿›åº¦åˆ—è¡¨: `GET /api/progress/students`
- âœ… å­¦ç”Ÿè¯¦ç»†è¿›åº¦: `GET /api/progress/student/:id`
- âœ… ç­çº§æ•´ä½“è¿›åº¦: `GET /api/progress/class/:id`
- âœ… è¿›åº¦åˆ†ææŠ¥å‘Š: `GET /api/progress/analytics`

### 5. æˆå°±ç³»ç»Ÿç®¡ç†

#### æˆå°±ç®¡ç†åŠŸèƒ½
- âœ… åˆå§‹åŒ–æˆå°±: `POST /api/achievements/initialize`
- âœ… æˆå°±åˆ—è¡¨: `GET /api/achievements`
- âœ… æˆå°±ç»Ÿè®¡: `GET /api/achievements/stats`
- âœ… æˆå°±æ’è¡Œæ¦œ: `GET /api/achievements/leaderboard`

### 6. é€šçŸ¥ç³»ç»Ÿç®¡ç†

#### é€šçŸ¥ç®¡ç†åŠŸèƒ½
- âœ… åˆ›å»ºé€šçŸ¥: `POST /api/notifications`
- âœ… é€šçŸ¥åˆ—è¡¨: `GET /api/notifications`
- âœ… å‘é€é€šçŸ¥: `POST /api/notifications/:id/send`
- âœ… é€šçŸ¥æ¨¡æ¿: `GET/POST /api/notifications/templates`
- âœ… é€šçŸ¥ç»Ÿè®¡: `GET /api/notifications/stats`

## ğŸ›¡ï¸ æƒé™æ§åˆ¶

### APIæƒé™ç¤ºä¾‹

```typescript
// è¶…çº§ç®¡ç†å‘˜ä¸“ç”¨
router.delete('/institutions/:id', authenticate, authorize('super_admin'), deleteInstitution);

// ç®¡ç†å‘˜åŠä»¥ä¸Š
router.get('/users', authenticate, authorize('admin', 'super_admin'), getUsers);

// æ•™å¸ˆåŠä»¥ä¸Š
router.get('/progress/students', authenticate, authorize('teacher', 'admin', 'super_admin'), getStudentProgress);
```

### æƒé™çº§åˆ«

1. **super_admin**: å…¨å¹³å°æœ€é«˜æƒé™
2. **admin**: æœºæ„ç®¡ç†æƒé™
3. **teacher**: æ•™å­¦ç®¡ç†æƒé™
4. **student**: åŸºç¡€å­¦ä¹ æƒé™

## ğŸ“Š ç®¡ç†åå°ç•Œé¢

### ä¸»è¦ç®¡ç†åŠŸèƒ½é¡µé¢

1. **æœºæ„ç®¡ç†é¡µé¢** (`/admin/institutions`)
   - æœºæ„åˆ—è¡¨ã€åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
   - æœºæ„ç”¨æˆ·ç®¡ç†
   - æœºæ„ç»Ÿè®¡æ•°æ®

2. **ç”¨æˆ·ç®¡ç†é¡µé¢** (`/admin/users`)
   - ç”¨æˆ·åˆ—è¡¨ã€æƒé™ç®¡ç†
   - ç”¨æˆ·ç»Ÿè®¡åˆ†æ
   - æ‰¹é‡æ“ä½œ

3. **å­¦ç”Ÿè¿›åº¦é¡µé¢** (`/admin/progress`)
   - å­¦ç”Ÿå­¦ä¹ è¿›åº¦ç›‘æ§
   - ç­çº§ç»Ÿè®¡åˆ†æ
   - å­¦ä¹ æ•°æ®æŠ¥å‘Š

4. **æˆå°±ç®¡ç†é¡µé¢** (`/admin/achievements`)
   - æˆå°±ç³»ç»Ÿé…ç½®
   - æˆå°±ç»Ÿè®¡å’Œæ’è¡Œ
   - ç”¨æˆ·æ¿€åŠ±æ•°æ®

5. **é€šçŸ¥ç®¡ç†é¡µé¢** (`/admin/notifications`)
   - ç³»ç»Ÿé€šçŸ¥å‘é€
   - é€šçŸ¥æ¨¡æ¿ç®¡ç†
   - æ¶ˆæ¯ç»Ÿè®¡åˆ†æ

## ğŸ” å®‰å…¨å»ºè®®

### 1. é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹å¯†ç 

**PUT** `/api/auth/profile`
```json
{
  "oldPassword": "Admin123456",
  "newPassword": "YourNewSecurePassword123!"
}
```

### 2. å®šæœŸæ›´æ¢å¯†ç 
- å»ºè®®æ¯3ä¸ªæœˆæ›´æ¢ç®¡ç†å‘˜å¯†ç 
- ä½¿ç”¨å¤æ‚å¯†ç ï¼ˆå¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šå­—ç¬¦ï¼‰

### 3. æƒé™æœ€å°åŒ–åŸåˆ™
- åªç»™å¿…è¦çš„ç”¨æˆ·åˆ†é…ç®¡ç†æƒé™
- å®šæœŸå®¡æŸ¥ç”¨æˆ·æƒé™
- åŠæ—¶åˆ é™¤ç¦»èŒäººå‘˜è´¦æˆ·

## ğŸš¨ æ•…éšœæ’é™¤

### 1. åˆ›å»ºç®¡ç†å‘˜å¤±è´¥

```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
npm run create-admin:dev

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

### 2. ç™»å½•å¤±è´¥

- æ£€æŸ¥ç”¨æˆ·å/é‚®ç®±æ˜¯å¦æ­£ç¡®
- ç¡®è®¤å¯†ç è¾“å…¥æ— è¯¯
- éªŒè¯è´¦æˆ·æ˜¯å¦è¢«ç¦ç”¨ (`isActive: false`)

### 3. æƒé™ä¸è¶³

- ç¡®è®¤ç”¨æˆ·è§’è‰²æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥JWT tokenæ˜¯å¦æœ‰æ•ˆ
- éªŒè¯APIç«¯ç‚¹æƒé™è¦æ±‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ•°æ®åº“è¿æ¥çŠ¶æ€
2. ç¯å¢ƒå˜é‡é…ç½®
3. JWT_SECRET è®¾ç½®
4. MongoDB æ•°æ®å®Œæ•´æ€§

**ç®¡ç†å‘˜åŠŸèƒ½å·²å®Œæ•´å®ç°ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼** ğŸ‰ 